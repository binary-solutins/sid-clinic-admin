<p-toast></p-toast>
<div class="card page-content">
    <div class="main-content">
        <div class="sm:flex justify-content-between items-center gap-4 mb-4">
            <div class="sm:flex gap-4 mb-3 sm:mb-0">
                <p-button
                    severity="{{ getButtonSeverity('all') }}"
                    label="All"
                    (click)="getDoctorsList('all')"
                />
                <p-button
                    severity="{{ getButtonSeverity('approved') }}"
                    label="Approved"
                    (click)="getDoctorsList('approved')"
                />
                <p-button
                    severity="{{ getButtonSeverity('pending') }}"
                    label="Pending"
                    (click)="getDoctorsList('pending')"
                />
            </div>
            <div class="">
                <p-button severity="primary" label=" + Add User" />
            </div>
        </div>

        <p-progressSpinner
            *ngIf="loading"
            styleClass="overlay-spinner"
        ></p-progressSpinner>

        <p-table
            *ngIf="!loading"
            [value]="doctors"
            [paginator]="true"
            [rows]="5"
            [tableStyle]="{ 'min-width': '50rem' }"
            [rowsPerPageOptions]="rowsPerPageOptions"
        >
            <ng-template pTemplate="header">
                <tr>
                    <th style="width: 20%">{{ labelConstants.Name }}</th>
                    <th style="width: 20%">
                        {{ labelConstants.Speciality }}
                    </th>
                    <th style="width: 20%">{{ labelConstants.City }}</th>
                    <th style="width: 15%">
                        {{ labelConstants.Approved }}
                    </th>
                    <th style="width: 15%">{{ labelConstants.Active }}</th>
                    <th style="width: 10%">{{ labelConstants.Actions }}</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-doctor>
                <tr>
                    <td>
                        <div class="flex align-items-center">
                            <img
                                class=""
                                width="33"
                                height="33"
                                [src]="doctor.doctorPhoto"
                                alt="user"
                                (error)="handleImageError($event)"
                            />
                            <p class="ml-2">{{ doctor.User.name }}</p>
                        </div>
                    </td>
                    <td>{{ doctor.specialty }}</td>
                    <td>{{ doctor.city }}</td>
                    <td>
                        <p-inputSwitch
                            [(ngModel)]="doctor.isApproved"
                            (onChange)="updateDoctorStatus(doctor)"
                        >
                        </p-inputSwitch>
                    </td>
                    <td>
                        <p-inputSwitch
                            [(ngModel)]="doctor.is_active"
                            (onChange)="changeDoctorActiveStatus(doctor)"
                        />
                    </td>
                    <td>
                        <i
                            class="text-black-alpha-80 text-xl mx-2 pi pi-eye"
                            (click)="showDoctorProfile(doctor.id)"
                        ></i>
                        <i
                            class="text-red-400 text-xl mx-2 pi pi-trash"
                            (click)="deleteDoctor(doctor.id)"
                        ></i>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>
</div>
